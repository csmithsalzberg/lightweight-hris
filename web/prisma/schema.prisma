generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum EmploymentStatus {
  active
  leave
  terminated
}

model Employee {
  id            String            @id @default(cuid())
  name          String
  title         String
  department    String
  managerId     String?
  contactEmail  String            @unique
  contactPhone  String?
  hireDate      DateTime
  salary        Int
  status        EmploymentStatus

  manager       Employee?         @relation("ManagerReports", fields: [managerId], references: [id], onDelete: SetNull)
  reports       Employee[]        @relation("ManagerReports")

  // Auth linkage (optional one-to-one)
  user          User?

  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
}

model ChangeLog {
  id          String   @id @default(cuid())
  entityType  String
  entityId    String
  action      String
  changes     Json
  actorId     String?
  createdAt   DateTime @default(now())
}


enum Role {
  admin
  hr
  employee
}

model User {
  id            String   @id @default(cuid())
  email         String   @unique
  passwordHash  String
  role          Role
  employeeId    String?  @unique
  employee      Employee? @relation(fields: [employeeId], references: [id])

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}


